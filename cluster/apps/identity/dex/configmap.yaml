---
apiVersion: v1
kind: ConfigMap
metadata:
  name: dex-templates
  namespace: identity
data:
  approval.html: |
    {{ template "header.html" . }}
      <div class="theme-panel">
        <h2 class="theme-heading">Grant Access</h2>

        <hr class="dex-separator">
        <div>
          {{ if .Scopes }}
          <div class="dex-subtle-text">{{ .Client }} would like to:</div>
          <ul class="dex-list">
            {{ range $scope := .Scopes }}
            <li>{{ $scope }}</li>
            {{ end }}
          </ul>
          {{ else }}
          <div class="dex-subtle-text">{{ .Client }} has not requested any personal information</div>
          {{ end }}
        </div>
        <hr class="dex-separator">

        <div>
          <div class="theme-form-row">
            <form method="post">
              <input type="hidden" name="req" value="{{ .AuthReqID }}"/>
              <input type="hidden" name="approval" value="approve">
              <button type="submit" class="dex-btn theme-btn--success">
                  <span class="dex-btn-text">Grant Access</span>
              </button>
            </form>
          </div>
          <div class="theme-form-row">
            <form method="post">
              <input type="hidden" name="req" value="{{ .AuthReqID }}"/>
              <input type="hidden" name="approval" value="rejected">
              <button type="submit" class="dex-btn theme-btn-provider">
                  <span class="dex-btn-text">Cancel</span>
              </button>
            </form>
          </div>
        </div>

      </div>
    {{ template "footer.html" . }}
  device.html: |
    {{ template "header.html" . }}
      <div class="theme-panel">
        <h2 class="theme-heading">Enter User Code</h2>
        <form method="post" action="{{ .PostURL }}" method="get">
          <div class="theme-form-row">
            {{ if( .UserCode  )}}
            <input tabindex="2" required id="user_code" name="user_code" type="text" class="theme-form-input" autocomplete="off" value="{{.UserCode}}" {{ if .Invalid }} autofocus {{ end }}/>
            {{ else }}
            <input tabindex="2" required id="user_code" name="user_code" type="text" class="theme-form-input" placeholder="XXXX-XXXX" autocomplete="off"  {{ if .Invalid }} autofocus {{ end }}/>
            {{ end }}
          </div>

          {{ if .Invalid }}
          <div id="login-error" class="dex-error-box">
            Invalid or Expired User Code
          </div>
          {{ end }}
          <button tabindex="3" id="submit-login" type="submit" class="dex-btn theme-btn--primary">Submit</button>
        </form>
      </div>
    {{ template "footer.html" . }}
  device_success.html: |

  error.html: |
    {{ template "header.html" . }}

      <div class="theme-panel">
        <h2 class="theme-heading">{{ .ErrType }}</h2>
        <p>{{ .ErrMsg }}</p>
      </div>

    {{ template "footer.html" . }}
  footer.html: |
    </div>
    </body>
    </html>
  header.html: |
    <!DOCTYPE html>
      <html>
        <head>
          <meta charset="utf-8">
          <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
          <title>{{ issuer }}</title>
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <link href="{{ url .ReqPath "static/main.css" }}" rel="stylesheet">
          <link href="{{ url .ReqPath "theme/styles.css" }}" rel="stylesheet">
          <link rel="icon" href="{{ url .ReqPath "theme/favicon.png" }}">
        </head>

        <body class="theme-body">
          <div class="theme-navbar">
            <div class="theme-navbar__logo-wrap">
              <img class="theme-navbar__logo" src="{{ url .ReqPath logo }}">
            </div>
          </div>

          <div class="dex-container">
  login.html: |
    {{ template "header.html" . }}

      <div class="theme-panel">
        <h2 class="theme-heading">Log in to {{ issuer }} </h2>
        <div>
          {{ range $c := .Connectors }}
            <div class="theme-form-row">
              <a href="{{ $c.URL }}" target="_self">
                <button class="dex-btn theme-btn-provider">
                  <span class="dex-btn-icon dex-btn-icon--{{ $c.Type }}"></span>
                  <span class="dex-btn-text">Log in with {{ $c.Name }}</span>
                </button>
              </a>
            </div>
          {{ end }}
        </div>
      </div>

    {{ template "footer.html" . }}
  oob.html: |
    {{ template "header.html" . }}

    <div class="theme-panel">
      <h2 class="theme-heading">Login Successful</h2>
      <p>Please copy this code, switch to your application and paste it there:</p>
      <input type="text" class="theme-form-input" value="{{ .Code }}" />
    </div>

    {{ template "footer.html" . }}
  password.html: |
    {{ template "header.html" . }}

    <div class="theme-panel">
      <h2 class="theme-heading">Log in to Your Account</h2>
      <form method="post" action="{{ .PostURL }}">
        <div class="theme-form-row">
          <div class="theme-form-label">
            <label for="userid">{{ .UsernamePrompt }}</label>
          </div>
          <input tabindex="1" required id="login" name="login" type="text" class="theme-form-input" placeholder="{{ .UsernamePrompt | lower }}" {{ if .Username }} value="{{ .Username }}" {{ else }} autofocus {{ end }}/>
        </div>
        <div class="theme-form-row">
          <div class="theme-form-label">
            <label for="password">Password</label>
          </div>
          <input tabindex="2" required id="password" name="password" type="password" class="theme-form-input" placeholder="password" {{ if .Invalid }} autofocus {{ end }}/>
        </div>

        {{ if .Invalid }}
          <div id="login-error" class="dex-error-box">
            Invalid {{ .UsernamePrompt }} and password.
          </div>
        {{ end }}

        <button tabindex="3" id="submit-login" type="submit" class="dex-btn theme-btn--primary">Login</button>

      </form>
      {{ if .BackLink }}
      <div class="theme-link-back">
        <a class="dex-subtle-text" href="{{ .BackLink }}">Select another login method.</a>
      </div>
      {{ end }}
    </div>

    {{ template "footer.html" . }}
